{% extends 'base.html' %} {% load static %}{% load filters %} {% block 'title'%}Projetos{%endblock%} {% block 'head' %}
<link rel="stylesheet" href="{% static 'css/full-style.css' %}" />
<style>
  label.form-label {
    color: #012970 !important;
  }
  th.ocultar,
  td.ocultar {
    display: none;
  }
  .table-dot tbody {
    display: block; /* Permite que o tbody seja rolável */
    max-height: 10em; /* Define a altura máxima */
    overflow-y: auto; /* Permite a rolagem vertical quando necessário */
  }

  .table-dot thead,
  .table-dot tbody tr {
    display: table; /* Faz com que o thead e tr se comportem como uma tabela */
    width: 100%; /* Faz com que o thead e tr ocupem a largura total da tabela */
    table-layout: fixed; /* Garante que as células da tabela sejam de largura igual */
  }
  .modal-custom {
    max-width: 50%; /* Ou o valor que você quiser */
  }
</style>
{% endblock %} {% block 'subtitle' %}
<div class="row d-flex justify-content-center align-items-center mb-3">
  Equipamentos de Radiocomunicação
</div>
{% endblock %} {% block 'content' %} 
{% if messages %}
    {% for message in messages %}
        <div class="alert {{ message.tags }} stilo-message">
            {{ message }}
            <span class="close-alert" style="cursor: pointer;">&times;</span>
        </div>
    {% endfor %}
{% endif %}
<div class="card">
  <div class="card-body">
    <div class="row d-flex flex-row justify-content-between align-items-center">
      <div class="col-md-6">
        <h5 class="card-title w-20">Configurações</h5>
      </div>


    </div>
    <div class="row d-flex flex-row justify-content-between align-items-center">
      <!-- Default Tabs -->
      <ul class="nav nav-tabs d-flex" id="myTabjustified" role="tablist">
        <li class="nav-item flex-fill" role="presentation">
          <button
            class="nav-link w-100 active"
            id="andamento-tab"
            data-bs-toggle="tab"
            data-bs-target="#andamento-justified"
            type="button"
            role="tab"
            aria-controls="andamento"
            aria-selected="true"
          >
            Andamento
          </button>
        </li>
        <li class="nav-item flex-fill" role="presentation">
          <button
            class="nav-link w-100"
            id="documentos-tab"
            data-bs-toggle="tab"
            data-bs-target="#documentos-justified"
            type="button"
            role="tab"
            aria-controls="documentos"
            aria-selected="false"
          >
            Documentos
          </button>
        </li>
        <li class="nav-item flex-fill" role="presentation">
          <button
            class="nav-link w-100"
            id="equipamentos-tab"
            data-bs-toggle="tab"
            data-bs-target="#equipamentos-justified"
            type="button"
            role="tab"
            aria-controls="equipamentos"
            aria-selected="false"
          >
            Equipamentos/Serviços
          </button>
        </li>
        <li class="nav-item flex-fill" role="presentation">
          <button
            class="nav-link w-100"
            id="cronograma-tab"
            data-bs-toggle="tab"
            data-bs-target="#cronograma-justified_edit"
            type="button"
            role="tab"
            aria-controls="cronograma"
            aria-selected="false"
          >
            Cronograma
          </button>
        </li>
        <li class="nav-item flex-fill" role="presentation">
          <button
            class="nav-link w-100"
            id="observacoes-tab"
            data-bs-toggle="tab"
            data-bs-target="#observacoes-justified_edit"
            type="button"
            role="tab"
            aria-controls="observacoes"
            aria-selected="false"
          >
            Observações
          </button>
        </li>
      </ul>
    </div>
    <div class="row d-flex flex-row justify-content-between align-items-center">
      <!-- CONTEUDO DAS ABAS-->
      <div class="tab-content pt-2" id="myTabContent">
        <div class="tab-pane fade show active" id="andamento-justified" role="tabpanel" aria-labelledby="home-tab">
          <form action="{% url 'pacoteedit' id_pacote %}" method="post">
            {% csrf_token %}
          <div class="row align-items-top">
            <div class="col">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    TITULO
                    <span>| Escolha um titulo para identificar seu pacote</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <input
                      type="text"
                      class="form-control mb-0 changeble-item"
                      placeholder=""
                      aria-label="Local"
                      aria-describedby="basic-addon1"
                      id="inputTitlePacote"
                      name="inputTitlePacote"
                      value="{{pacote.titulo}}"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row align-items-top">
            <!-- Status Card -->
            <div class="col-xxl-6 col-md-6">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    FASE <span>| Informe o andamento do projeto</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <select class="form-select changeble-item" aria-label="Default select example" id="selectStatusNew_edit" name="selectStatusNew_edit">
                      <option selected disabled>Escolha o Status do projeto</option>
                      <option value="PJ" {% if pacote.status == 'PJ' %}selected{% endif %}>Planejamento</option>
                      <option value="RP" {% if pacote.status == 'RP' %}selected{% endif %}>RP em andamento</option>
                      <option value="PG" {% if pacote.status == 'PG' %}selected{% endif %}>PG em andamento</option>
                      <option value="EMP" {% if pacote.status == 'EMP' %}selected{% endif %}>Empenhado</option>
                      <option value="AGE" {% if pacote.status == 'AGE' %}selected{% endif %}>Aguardando entrega</option>
                      <option value="ENT" {% if pacote.status == 'ENT' %}selected{% endif %}>Entregue</option>
                      <option value="INS" {% if pacote.status == 'INS' %}selected{% endif %}>Instalado</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <!-- End Status Card -->
            <!-- Fase Card -->
            <div class="col-xxl-6 col-md-6">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    ESPECIFICA
                    <span
                      >| Especifique a fase caso tenha escolhido RP ou PG</span
                    >
                  </h5>
                  <div class="d-flex align-items-center">
                    <select
                      class="form-select changeble-item"
                      id="selectnewrp_edit"
                      name="selectnewrp_edit"
                      aria-label="Default select example"
                    >
                      <option selected disabled value="">
                        Escolha a fase do RP
                      </option>
                      <option value="rp-etp" {% if pacote.fase == 'rp-etp' %}selected{% endif %}>Elaboração do ETP</option>
                      <option value="rp-orcamentos" {% if pacote.fase == 'rp-orcamentos' %}selected{% endif %}>
                        Obtenção de Orçamentos
                      </option>
                      <option value="rp-precos" {% if pacote.fase == 'rp-precos' %}selected{% endif %}>
                        Mapa de Preços</option>
                      <option value="rp-autorizacao-dlf" {% if pacote.fase == 'rp-autorizacao-dlf' %}selected{% endif %}>
                        Pedido de autorização DLF
                      </option>
                      <option value="rp-gestao" {% if pacote.fase == 'rp-gestao' %}selected{% endif %}> 
                        Solicitação de Gestão de RP
                      </option>
                      <option value="rp-minuta" {% if pacote.fase == 'rp-minuta' %}selected{% endif %}>
                        Elaboração Minuta do Termo de Referência
                      </option>
                      <option value="rp-correcao-minuta" {% if pacote.fase == 'rp-correcao-minuta' %}selected{% endif %}>
                        Correção Minuta do Termo de Referência (ASSJUR)
                      </option>
                      <option value="rp-correcao-etp" {% if pacote.fase == 'rp-correcao-etp' %}selected{% endif %}>
                        Correção ETP (ASSJUR)
                      </option>
                      <option value="rp-formulario-adesao" {% if pacote.fase == 'rp-formulario-adesao' %}selected{% endif %}>
                        Formulário de Adesão
                      </option>
                      <option value="rp-encaminhado-gol" {% if pacote.fase == 'rp-encaminhado-gol' %}selected{% endif %}>
                        Encaminhado a Gol
                      </option>
                      <option value="rp-impugnacao" {% if pacote.fase == 'rp-impugnacao' %}selected{% endif %}>
                        Respondendo impugnação
                      </option>
                      <option value="rp-resposta-documentacao" {% if pacote.fase == 'rp-resposta-documentacao' %}selected{% endif %}>
                        Resposta a documentação
                      </option>
                    </select>
                    <select
                      class="form-select changeble-item"
                      id="selectnewpg_edit"
                      name="selectnewpg_edit"
                      aria-label="Default select example"
                    >
                      <option selected disabled value="">
                        Escolha a fase do PG
                      </option>
                      <option value="pg-autorizacao-dlf" {% if pacote.fase == 'pg-autorizacao-dlf' %}selected{% endif %}>
                        Pedido de autorização DLF
                      </option>
                      <option value="pg-etp" {% if pacote.fase == 'pg-etp' %}selected{% endif %}>
                        Elaboração do ETP</option>
                      <option value="pg-orcamentos" {% if pacote.fase == 'pg-orcamentos' %}selected{% endif %}>
                        Obtenção de Orçamentos
                      </option>
                      <option value="pg-precos" {% if pacote.fase == 'pg-precos' %}selected{% endif %}>
                        Mapa de Preços</option>
                      <option value="pg-minuta" {% if pacote.fase == 'pg-minuta' %}selected{% endif %}>
                        Elaboração Minuta do Termo de Referência
                      </option>
                      <option value="pg-extrato" {% if pacote.fase == 'pg-extrato' %}selected{% endif %}>
                        Extrato de Crédito</option>
                      <option value="pg-correcao-minuta" {% if pacote.fase == 'pg-correcao-minuta' %}selected{% endif %}>
                        Correção Minuta do Termo de Referência (ASSJUR)
                      </option>
                      <option value="pg-correcao-etp" {% if pacote.fase == 'pg-correcao-etp' %}selected{% endif %}>
                        Correção ETP (ASSJUR)
                      </option>
                    </select>
                    <div
                      id="terceiros_edit"
                      class="fw-bold text-primary h5"
                      name="terceiros_edit"
                    >
                      {% if pacote.fase == 'Terceiros' %}{% endif %}{{pacote.fase}}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row align-items-top">
            <!-- Natureza Card -->
            <div class="col-xxl-6 col-md-6">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    Etiqueta
                    <span>| Classifique a Etiqueta do projeto</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <select
                    class="form-select changeble-item"
                    aria-label="Default select example"
                    id="selectEtiquetaNew_edit"
                    name="selectEtiquetaNew_edit"
                >
                    <option selected disabled>
                        Escolha a Etiqueta projeto
                    </option>
                    <option value="radio" {% if pacote.etiqueta == 'radio' %}selected{% endif %}>Radiocomunicação</option>
                    <option value="telefonia" {% if pacote.etiqueta == 'telefonia' %}selected{% endif %}>Telefonia</option>
                    <option value="audioevideo" {% if pacote.etiqueta == 'audioevideo' %}selected{% endif %}>Audio e video</option>
                    <option value="outros" {% if pacote.etiqueta == 'outros' %}selected{% endif %}>Outros</option>
                </select>
                
                  </div>
                </div>
              </div>
            </div>
            <!-- TIPO Card -->
            <div class="col-xxl-6 col-md-6">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    NATUREZA
                    <span>| Natureza a ser fornecido se material ou serviço</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <select
                      class="form-select changeble-item"
                      aria-label="Default select example"
                      id="selectNaturezaNew_edit"
                      name="selectNaturezaNew_edit"
                    >
                      <option selected disabled>Escolha a natureza</option>
                      <option value="material" {% if pacote.natureza == 'material' %}selected{% endif %}>Material</option>
                      <option value="servico" {% if pacote.natureza == 'servico' %}selected{% endif %}>Serviço</option>
                      <option value="materialservico" {% if pacote.natureza == 'materialservico' %}selected{% endif %}>Material/Serviço</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="d-flex flex-row justify-content-between align-items-center">
            <button class="btn btn-success w-20 fw-bold">Salvar alterações</button> 
          </div>
          </form>
        </div>
        <div class="tab-pane fade" id="documentos-justified" role="tabpanel" aria-labelledby="profile-tab">
        <form action="{% url 'pacoteedit' id_pacote %}" method="post">
          {% csrf_token %}
            <div class="row align-items-top">
            <!-- CONTRATO Card -->
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    CONTRATO <span>| Nº do Contrato do Pacote</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <div class="input-group mb-3">
                      <span class="input-group-text" id="basic-addon1">Nº</span>
                      <input
                        type="text"
                        class="form-control mb-0 changeble-item"
                        placeholder="Contrato"
                        aria-label="Local"
                        aria-describedby="basic-addon1"
                        id="inputContratoNew_edit"
                        name="inputContratoNew_edit"
                        value="{{pacote.contrato}}"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- End CONTRATO Card -->
            <!-- DATA INICIO Card -->
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    DATA INICIAL <span>| Início da Vigência</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <div class="mb-3">
                      <input
                        type="date"
                        class="form-control changeble-item"
                        id="dateInitialInput_edit"
                        name="dateInitialInput_edit"
                        value="{{pacote.contratoinit|inputformatdate}}"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- End DATA INICIO Card -->
            <!-- DATA FINAL Card -->
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    DATA FINAL <span>| Início da Vigência</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <div class="mb-3">
                      <input
                        type="date"
                        class="form-control changeble-item"
                        id="dateFinalInput_edit"
                        name="dateFinalInput_edit"
                        value="{{pacote.contratoend|inputformatdate}}"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row align-items-top">
            <div class="col-xxl-6 col-md-6">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    SEI <span>| Numero de documento referência</span>
                  </h5>
                  <div class="d-flex flex-column align-items-center">
                    <div class="input-group mb-3">
                      <button
                        class="btn btn-primary fw-bold"
                        type="button"
                        id="button-addon1-new_edit"
                      >
                        +
                      </button>
                      <input
                        type="text"
                        class="form-control"
                        id="inputText-new_edit"
                        placeholder=""
                        aria-label="Example text with button addon"
                        aria-describedby="button-addon1-new_edit"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- End LOCALIZADO Card -->
            <!-- LOCALIZADO Card -->
            <div class="col-xxl-6 col-md-6">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <div class="d-flex flex-column align-items-center">
                    <div
                      class="list-container d-flex flex-column justify-content-around w-100 changeble-item"
                      id="listContainer-new"
                      style="height: 8.8em; overflow-y: auto"
                    >
                  {% for sei in pacote.doc_ref|sei_interable %}
                  {% if sei == "" %}
                  {% else %}
                  <div class="d-flex flex-row justify-content-between w-100 align-items-center mb-1">
                    <p class="labelsei">{{sei}}</p>
                    <button class="btn btn-danger btn-sm me-2" onclick="removeItem(event)">X</button>
                  </div>
                  {% endif %}
                  {% endfor %}
                  
                  </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- input que deve ser escontido -->
          <input
            type="text"
            class="form-control changeble-item"
            name="hiddensei_edit"
            id="hiddensei_edit"
            value="{{pacote.doc_ref}}"
          />
            <button class="btn btn-success w-20 fw-bold mt-4">Salvar alterações</button>
          </form>
        </div>
        <div class="tab-pane fade" id="equipamentos-justified" role="tabpanel" aria-labelledby="profile-tab">
          <div class="row align-items-top">
            <!--Inicio Conteudo-->
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    Categoria
                    <span>| Selecione a categoria desejada</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <select
                      class="form-select changeble-item"
                      aria-label="Default select example"
                      id="selectCategoria_edit"
                      name="selectCategoria_edit"
                    >
                      <option selected disabled>Escolha a categoria</option>
                      <option value="material">Material</option>
                      <option value="servico">Servico</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <h5 class="card-title">
                    SELECIONAR
                    <span>| Selecione o equipamento/serviço na lista</span>
                  </h5>
                  <div class="d-flex align-items-center">
                    <select
                      class="form-select changeble-item"
                      aria-label="Default select example"
                      id="selectEquip_edit"
                      name="selectEquip_edit"
                    >
                      <option selected disabled>
                        Escolha o equipamento/serviço
                      </option>
                      {% for equipamento in all_equipamentos %}
                      <option value="{{equipamento.id}}-{{equipamento.classe}}-{{equipamento.natureza}}-{{equipamento.valor_portal}}">
                        {{equipamento.titulo}}
                      </option>
                      {% endfor %}
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card revenue-card">
                <div class="card-body">
                  <div class="d-flex justify-content-center align-items-center">
                    <button
                      type="button"
                      class="btn btn-primary fw-bold p-2 m-4"
                      data-bs-toggle="modal"
                      data-bs-target="#modalCreateEquip_Add"
                    >
                      Novo Equipamento/Serviço
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row align-items-center">
            <div
              class="col-xxl-12 col-md-12 w-80 d-flex justify-content-center align-items-center"
            >
              <button
                type="button"
                class="btn btn-success fw-bold mb-4 display-3"
                style="font-size: 1.5em;"
                onclick="putModelData()"
                data-bs-toggle="modal" 
                data-bs-target="#modalCreateFullEquip"
                id="buttonAddEquip"
                >
                Adicionar Equipamento
              </button>
            </div>
          </div>
          <div class="row align-items-top">
            <div class="col-xxl-12 col-md-12">
              <div class="line-container">
                <div class="line"></div>
                <span class="span-line">Equipamentos</span>
                <div class="line"></div>
              </div>
            </div>
          </div>
          <div class="row align-items-top">
            <div class="col-xxl-12 col-md-12">
              <div class="card">
                <div class="card-body">
                  <!-- Tabela de Equipamentos -->
                  <table
                    id="main-table_edit"
                    class="table table-striped table-sm table-dot"
                  >
                    <thead>
                      <tr>
                        <th scope="col" class="rot-info rot-sm">Titulo</th>
                        <th scope="col" class="rot-info rot-sm ocultar">Di</th>
                        <th scope="col" class="rot-info rot-sm">Classe</th>
                        <th scope="col" class="rot-info rot-sm">Natureza</th>
                        <th scope="col" class="rot-info rot-sm">Status</th>
                        <th scope="col" class="rot-info rot-sm ocultar">
                          Val1
                        </th>
                        <th scope="col" class="rot-info rot-sm ocultar">
                          Val2
                        </th>
                        <th scope="col" class="rot-info rot-sm ocultar">
                          Val3
                        </th>
                        <th scope="col" class="rot-info rot-sm ocultar">
                          Val Media
                        </th>
                        <th scope="col" class="rot-info rot-sm ocultar">
                          BolValor
                        </th>
                        <th scope="col" class="rot-info rot-sm">Valor</th>
                        <th scope="col" class="rot-info rot-sm">Qtd Un</th>
                        <th scope="col" class="rot-info rot-sm">Qtd Total</th>
                        <th scope="col" class="rot-info rot-sm ocultar">
                          Local
                        </th>
                        <th scope="col" class="rot-info rot-sm ocultar">
                          Dt Ent
                        </th>
                        <th scope="col" class="rot-info rot-sm ocultar">
                          Dt Inst
                        </th>
                        <th scope="col" class="rot-info rot-sm ocultar">Obs</th>
                        <th scope="col" class="rot-info rot-sm">Destino</th>
                        <th scope="col" class="rot-info rot-sm">Ações</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for equip in pacote.id|render_table:'equipamento' %}
                      <tr>
                        <td  class="rot-info rot-sm">{{equip.equipamento.titulo}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.equipamento.id}}</td>
                        <td  class="rot-info rot-sm">{{equip.equipamento.classe}}</td>
                        <td  class="rot-info rot-sm">{{equip.equipamento.natureza}}</td>
                        <td  class="rot-info rot-sm">{{equip.get_entrega_instalacao_display}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.valor_1}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.valor_2}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.valor_3}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.valor_medio}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.usa_preco_portal}}</td>
                        <td  class="rot-info rot-sm">{{equip.id|kindvalue}}</td>
                        <td  class="rot-info rot-sm">{{equip.quantidade}}</td>
                        <td  class="rot-info rot-sm">{{equip.id|valortotalequip}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.local}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.data_entrega}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.data_instalacao}}</td>
                        <td  class="rot-info rot-sm ocultar">{{equip.observacoes}}</td>
                        <td  class="rot-info rot-sm">{{equip.destino}}</td>
                        <td>
                          <!-- Botão para apagar um registro-->
                          <button 
                          type="button" 
                          class="btn btn-danger btn-sm equipser" 
                          data-bs-toggle="modal" 
                          data-bs-target="#modalDeleteEquip" 
                          data-bs-packagedelequip="{{equip.id}}" 
                          >
                          <i class="ri-delete-bin-6-line"></i></button>                   
                          <!-- Botão para editar um registro-->
                          <button 
                          type="button" 
                          class="btn btn-primary btn-sm equipser" 
                          onchange="calcMediaModel('modalequipValor1' ,'modalequipValor2', 'modalequipValor3', 'modalequipValorMedio')"
                          data-bs-toggle="modal" 
                          data-bs-target="#modalEditEquip" 
                          data-bs-equipamento.titulo="{{equip.equipamento.titulo}}"
                          data-bs-equipamento.id="{{equip.equipamento.id}}-{{equip.equipamento.classe}}-{{equip.equipamento.natureza}}-{{equip.equipamento.valor_portal}}"
                          data-bs-equipamento.classe="{{equip.equipamento.classe}}"
                          data-bs-equipamento.natureza="{{equip.equipamento.natureza}}"
                          data-bs-entrega_instalacao="{{equip.entrega_instalacao}}"
                          data-bs-equip.valor_1="{{equip.valor_1}}"
                          data-bs-equip.valor_2="{{equip.valor_2}}"
                          data-bs-equip.valor_3="{{equip.valor_3}}"
                          data-bs-valor_preco_portal="{{equip.equipamento.valor_portal}}"
                          data-bs-usa_preco_portal="{{equip.usa_preco_portal}}"
                          data-bs-equip.valor_unit="{{equip.id|kindvalue}}"
                          data-bs-equip.quantidade="{{equip.quantidade}}"
                          data-bs-equip.valor_total="{{equip.id|valortotalequip}}"
                          data-bs-equip.local="{{equip.local}}"
                          data-bs-equip.data_entrega="{{equip.data_entrega|inputformatdate}}"
                          data-bs-equip.data_instalacao="{{equip.data_instalacao|inputformatdate}}"
                          data-bs-equip.observacoes="{{equip.observacoes}}"
                          data-bs-equip.destino="{{equip.destino}}"
                          data-bs-packageequip="{{equip.id}}">
                          <i class="ri-edit-box-line"></i></button>    
                        </td>               
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                  <!-- End Table with stripped rows -->
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="cronograma-justified_edit" role="tabpanel" aria-labelledby="profile-tab">
          <div class="row align-items-center">
            <div
              class="col-xxl-12 col-md-12 w-80 d-flex justify-content-center align-items-center"
            >
              <button
                type="button"
                class="btn btn-success fw-bold mb-4"
                data-bs-toggle="modal"
                data-bs-target="#modalCreateTask_Add"
              >
                Adicionar Tarefas
              </button>
            </div>
          </div>
          <div class="row align-items-top">
            <div class="col-xxl-12 col-md-12">
              <div class="line-container">
                <div class="line"></div>
                <span class="span-line">Tarefas</span>
                <div class="line"></div>
              </div>
            </div>
          </div>
          <div class="row align-items-top">
            <div class="col-xxl-12 col-md-12">
              <div class="card">
                <div class="card-body">
                  <!-- Table with stripped rows -->
                  <table
                    id="listTaskTable_edit"
                    class="table table-striped table-sm table-dot"
                  >
                    <thead>
                      <tr>
                        <th scope="col" class="rot-info rot-sm">Tarefa</th>
                        <th scope="col" class="rot-info rot-sm ocultar">Descrição</th>
                        <th scope="col" class="rot-info rot-sm">Status</th>
                        <th scope="col" class="rot-info rot-sm">Prioridade</th>
                        <th scope="col" class="rot-info rot-sm ocultar">Início P</th>
                        <th scope="col" class="rot-info rot-sm ocultar">Fim P</th>
                        <th scope="col" class="rot-info rot-sm ocultar">Inicio R</th>
                        <th scope="col" class="rot-info rot-sm ocultar">Fim R</th>
                        <th scope="col" class="rot-info rot-sm">Inicio</th>
                        <th scope="col" class="rot-info rot-sm">Fim</th>
                        <th scope="col" class="rot-info rot-sm">Duração(dias)</th>
                        <th scope="col" class="rot-info rot-sm ocultar">Observações</th>
                        <th scope="col" class="rot-info rot-sm">Ações</th>
                      </tr>
                    </thead>
                    <tbody class="changeble-item">
                      {% for task in pacote.id|render_table:'cronograma' %}
                      <tr>
    
                        <td  class="rot-info rot-sm">{{task.titulo}}</td>
                        <td  class="rot-info rot-sm ocultar">{{task.descricao}}</td>
                        <td  class="rot-info rot-sm">{{task.status}}</td>
                        <td  class="rot-info rot-sm">{{task.prioridade}}</td>
                        <td  class="rot-info rot-sm ocultar">{{task.data_inicio_planejada}}</td>
                        <td  class="rot-info rot-sm ocultar">{{task.data_fim_planejada}}</td>
                        <td  class="rot-info rot-sm ocultar">{{task.data_inicio_real}}</td>
                        <td  class="rot-info rot-sm ocultar">{{task.data_fim_real}}</td>
                        <td  class="rot-info rot-sm ">{{task.data_inicio_planejada|initialDate:task.data_inicio_real|formatdate}}</td>
                        <td  class="rot-info rot-sm ">{{task.data_fim_planejada|finalDate:task.data_fim_real|formatdate}}</td>
                        <td  class="rot-info rot-sm "></td>
                        <td  class="rot-info rot-sm ocultar">{{task.observacoes}}</td>
                        <td>
                          <!-- Botão para apagar um registro-->
                          <button 
                          type="button" 
                          class="btn btn-danger btn-sm equipser" 
                          data-bs-toggle="modal" 
                          data-bs-target="#modalDeleteTask" 
                          data-bs-idtask="{{task.id}}"
                          data-bs-idpacote="{{pacote.id}}"
                          >
                          <i class="ri-delete-bin-6-line"></i></button>                   
                          <!-- Botão para editar um registro-->
                          <button 
                          type="button" 
                          class="btn btn-primary btn-sm equipser" 
                          onchange="calcMediaModel('modalequipValor1' ,'modalequipValor2', 'modalequipValor3', 'modalequipValorMedio')"
                          data-bs-toggle="modal" 
                          data-bs-target="#modalEditTask"
                          data-bs-packagedeltask="{{task.id}}"
                          data-bs-titletask="{{task.titulo}}"
                          data-bs-desctask="{{task.descricao}}"
                          data-bs-statustask="{{task.status}}"
                          data-bs-prioritask="{{task.prioridade}}"
                          data-bs-initask="{{task.data_inicio_planejada|inputformatdate}}"
                          data-bs-fimtask="{{task.data_fim_planejada|inputformatdate}}"
                          data-bs-inirealtask="{{task.data_inicio_real|inputformatdate}}"
                          data-bs-fimrealtask="{{task.data_fim_real|inputformatdate}}"
                          data-bs-obs="{{task.observacoes}}"
                          data-bs-idtask="{{task.id}}"
                          data-bs-idpacote="{{pacote.id}}">
                          <i class="ri-edit-box-line"></i>
                        </button>    
                        </td>               
                      </tr>
                      {% endfor %}
    
                    </tbody>
                  </table>
                  <!-- End Table with stripped rows -->
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="observacoes-justified_edit" role="tabpanel" aria-labelledby="profile-tab">
          <div class="row align-items-center">
            <div
              class="col-xxl-12 col-md-12 w-80 d-flex justify-content-center align-items-center"
            >
              <button
                type="button"
                class="btn btn-success fw-bold mb-4"
                data-bs-toggle="modal"
                data-bs-target="#modalCreateObsPen"
              >
                Adicionar Observação/Pendencia
              </button>
            </div>
          </div>
          <!-- Divisão para Obs/Pen -->
          <div class="row align-items-top">
            <div class="col-xxl-12 col-md-12">
              <div class="line-container">
                <div class="line"></div>
                <span class="span-line">Tarefas</span>
                <div class="line"></div>
              </div>
            </div>
          </div>
          <div class="row align-items-center">
            <div class="col-xxl-12 col-md-12">
              <div class="card">
                <div class="card-body">
                  <!-- Table with stripped rows -->
                  <table
                    id="listObsPenTable"
                    class="table table-striped table-sm table-dot"
                  >
                    <thead>
                      <tr>
                        <th scope="col" class="rot-info rot-sm">Descrição</th>
                        <th scope="col" class="rot-info rot-sm">Categoria</th>
                        <th scope="col" class="rot-info rot-sm">Data</th>
                        <th scope="col" class="rot-info rot-sm">Ações</th>
                      </tr>
                    </thead>
                    <tbody class="changeble-item">
                      {% for obspen in pacote.id|render_table:'obspen' %}
                      <tr>
                        <td  class="rot-info rot-sm">{{obspen.decricao}}</td>
                        <td  class="rot-info rot-sm">{{obspen.categoria}}</td>
                        <td  class="rot-info rot-sm">{{obspen.data_obs_pend}}</td>
                        <td  class="rot-info rot-sm">{{obspen.class_obs_pend}}</td>
                        <td>
                          <!-- Botão para apagar um registro-->
                          <button 
                          type="button" 
                          class="btn btn-danger btn-sm equipser" 
                          data-bs-toggle="modal" 
                          data-bs-target="#modalDeleteObsPen" 
                          data-bs-idobspen="{{obspen.id}}"
                          data-bs-idpacote="{{pacote.id}}"
                          >
                          <i class="ri-delete-bin-6-line"></i></button>                   
                          <!-- Botão para editar um registro-->
                          <button 
                          type="button" 
                          class="btn btn-primary btn-sm equipser" 
                          data-bs-toggle="modal" 
                          data-bs-target="#modalEditObsPen"
                          data-bs-descobspen="{{obspen.decricao}}"
                          data-bs-catobspen="{{obspen.categoria}}"
                          data-bs-dateobspen="{{obspen.data_obs_pend|inputformatdate}}"
                          data-bs-classobspen="{{obspen.class_obs_pend}}"
                          data-bs-idobspen="{{obspen.id}}"
                          data-bs-idpacote="{{pacote.id}}">
                          <i class="ri-edit-box-line"></i>
                        </button>    
                        </td>                                    
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                  <!-- End Table with stripped rows -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- FIM CONTEUDO DAS ABAS-->
    </div>
  </div>
  <div class="card-footer text-muted">
    <div class="d-flex justify-content-end align-items-center">
      <button type="button" class="btn btn-danger w-20 fw-bold" data-bs-toggle="modal" data-bs-target="#confirmationModal">
        Deletar Pacote
    </button>
        </div>
</div>
<!-- SEÇÃO DE MODAIS -->
<!-- Modal para adicionar equipamento -->
<!-- Modal -->
<div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Confirmação de exclusão</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
          <div class="modal-body">
              Você realmente deseja excluir este pacote?
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
              <a href="{% url 'removepackage' id_pacote %}" class="btn btn-danger">OK</a>
          </div>
      </div>
  </div>
</div>

<div class="modal fade" id="modalCreateFullEquip" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable modal-custom">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modaltitleequip" class="modal-title fw-bold">Editar Equipamento </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="formEditEquipFull" action="{% url 'createfullequip' id_pacote %}" method="POST">
          {% csrf_token %}
          <div class="container">

            <div class="row py-2">
              <div class="col-md-12">
                <label for="modalEquipFullList" class="form-label text-primary"
                  >Equipamentos</label
                >
                <div class="d-flex align-items-center">
                  <select
                    class="form-select changeble-item"
                    aria-label="Default select example"
                    id="modalEquipFullList"
                    name="modalEquipFullList"
                    disabled
                  >
                    <option selected disabled>
                      Escolha o equipamento/serviço
                    </option>
                    {% for equipamento in all_equipamentos %}
                    <option value="{{equipamento.id}}">
                      {{equipamento.titulo}}
                    </option>
                    {% endfor %}
                  </select>
                  <input type="hidden" id="modalEquipFullListHidden" name="modalEquipFullListHidden">
                </div>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="modalequipFullClasse" class="form-label text-primary"
                  >Classe</label
                >
                <select
                class="form-select"
                aria-label="Default"
                id="modalequipFullClasse"
                name="modalequipFullClasse"
                disabled
              >
                <option selected disabled>Escolha a Classe</option>
                <option value="consumo">Consumo</option>
                <option value="permanente">Permanente</option>
              </select>
              <input type="hidden" id="modalequipFullClasseHidden" name="modalequipFullClasseHidden">
              </div>
              <div class="col-md-6">
                <label for="modalequipFullNatureza" class="form-label text-primary"
                  >Natureza</label
                >
                <div class="d-flex align-items-center">
                  <select
                    class="form-select changeble-item"
                    aria-label="Default select example"
                    id="modalequipFullNatureza"
                    name="modalequipFullNatureza"
                    disabled
                  >
                    <option selected disabled>Escolha a Natureza</option>
                    <option value="material">Material</option>
                    <option value="servico">Serviço</option>
                    <option value="materialservico">Material/Serviço</option>
                  </select>
                  <input type="hidden" id="modalequipFullNaturezaHidden" name="modalequipFullNaturezaHidden">
                </div>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="modalequipFullEntrInst" class="form-label text-primary"
                  >Entrega/Instalação</label
                >
                <select
                class="form-select changeble-item"
                aria-label="Default"
                id="modalequipFullEntrInst"
                name="modalequipFullEntrInst"
                required
              >
                <option selected disabled>Status do item</option>
                <option value="demanda">Demanda</option>
                <option value="licitacao">Licitacao</option>
                <option value="aentregar">A entregar</option>
                <option value="entregue">Entregue</option>
                <option value="ainstalar">A instalar</option>
                <option value="instalado">Instalado</option>
              </select>
              </div>
              <div class="col-md-6">
                <label for="modalequipFullDest" class="form-label text-primary"
                  >Destino</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="modalequipFullDest"
                  name="modalequipFullDest"
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-4">
                <label for="modalequipFullValor1" class="form-label text-primary"
                  >Valor 1</label
                >
                <input
                type="text"
                id="modalequipFullValor1"
                class="form-control changeble-item"
                name="modalequipFullValor1"
                oninput="formatToCurrency(this)"
                onchange="calcMediaModel('modalequipFullValor1' ,'modalequipFullValor2', 'modalequipFullValor3', 'modalequipFullValorMedio')"
              />
              </div>
              <div class="col-md-4">
                <label for="modalequipFullValor2" class="form-label text-primary"
                  >Valor 2</label
                >
                <input
                type="text"
                id="modalequipFullValor2"
                class="form-control changeble-item"
                name="modalequipFullValor2"
                oninput="formatToCurrency(this)"
                onchange="calcMediaModel('modalequipFullValor1' ,'modalequipFullValor2', 'modalequipFullValor3', 'modalequipFullValorMedio')"
              />
              </div>
              <div class="col-md-4">
                <label for="modalequipFullValor3" class="form-label text-primary"
                  >Valor 3</label
                >
                <input
                type="text"
                id="modalequipFullValor3"
                class="form-control changeble-item"
                name="modalequipFullValor3"
                oninput="formatToCurrency(this)"
                onchange="calcMediaModel('modalequipFullValor1' ,'modalequipFullValor2', 'modalequipFullValor3', 'modalequipFullValorMedio')"
              />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-4">
                <label for="modalequipFullValorMedio" class="form-label text-primary"
                  >Valor Médio</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="modalequipFullValorMedio"
                  name="modalequipFullValorMedio"
                  oninput="formatToCurrency(this)"
                  onchange="formatToCurrency(this)"
                  readonly
                />
              </div>
              <div class="col-md-4">
                <label for="modalequipFullPrecoPortal" class="form-label text-primary"
                >Valor Portal</label
              >
              <input
                type="text"
                class="form-control"
                id="modalequipFullPrecoPortal"
                name="modalequipFullPrecoPortal"
                oninput="formatToCurrency(this)"
                readonly
              />
              </div>
              <div class="col-md-4">
                <div class="form-check form-switch">
                  <input
                    class="form-check-input changeble-item"
                    type="checkbox"
                    id="modalequipFullValorUnit"
                    name="modalequipFullValorUnit"
                  />
                  <label
                    class="form-check-label"
                    for="modalequipFullValorUnit"
                    >Usar valor padrão do portal </label
                  >
              </div>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="modalequipFullQtd" class="form-label text-primary"
                  >Quantidade</label
                >
                <input
                  type="number"
                  class="form-control"
                  id="modalequipFullQtd"
                  name="modalequipFullQtd"
                />
              </div>
              <div class="col-md-6">
                <label for="modalequipFullLocal" class="form-label text-primary"
                  >Local</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="modalequipFullLocal"
                  name="modalequipFullLocal"
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="modalequipFullDataEnt" class="form-label text-primary"
                  >Data Entrega</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="modalequipFullDataEnt"
                  name="modalequipFullDataEnt"
                />
              </div>
              <div class="col-md-6">
                <label for="modalequipFullDataInst" class="form-label text-primary"
                  >Data Instalação</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="modalequipFullDataInst"
                  name="modalequipFullDataInst"
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="modalequipFullObs" class="form-label text-primary"
                  >Observações</label
                >
                <textarea
                class="form-control changeble-item"
                style="height: 130px; font-size: 0.8em"
                id="modalequipFullObs"
                name="modalequipFullObs"
              ></textarea>
              </div>
            </div>
          </div>
          <input type="hidden" name="modalidpackageequip" id="modalidpackageequip" value="">
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Cria botão limpar-->
            <button type="submit" class="btn btn-success w-50" onclick="setHidden()">Adicionar Novo</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
 <!-- Modal Delete Equipamentos Inicio -->
 <div class="modal fade" id="modalDeleteEquip" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modaltitleequip" class="modal-title fw-bold text-danger h3">Excluir Equipamento </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="formDelEquip" data-action="{% url 'deleteequip' 0 %}" method="POST">
          {% csrf_token %}
          <h5 class="card-title"> Realmente deseja apagar permanentemente o(s) equipamento(s)?</h5>
          <button type="submit" class="btn btn-danger btn-lg m-3">Excluir</button>
          <button
          type="button"
          class="btn btn-secondary btn-lg m-3"
          data-bs-dismiss="modal"
          >
          Cancelar
        </button>
      </form>
      </div>

    </div>
  </div>
</div>
<!-- Modal Delete Equipamentos Fim -->
<!-- Modal Edit Equpamento Scrollable -->
<div class="modal fade" id="modalEditEquip" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable modal-custom">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modaltitleequip" class="modal-title fw-bold">Editar Equipamento </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="formEditEquip" data-action="{% url 'allservpack' 0 %}" method="POST">
          {% csrf_token %}
          <div class="container">

            <div class="row py-2">
              <div class="col-md-12">
                <label for="modalEquipList" class="form-label text-primary"
                  >Equipamentos</label
                >
                <div class="d-flex align-items-center">
                  <select
                    class="form-select changeble-item"
                    aria-label="Default select example"
                    id="modalEquipList"
                    name="modalEquipList"
                    onchange="loadclassnatprice()"
                  >
                    <option selected disabled>
                      Escolha o equipamento/serviço
                    </option>
                    {% for equipamento in all_equipamentos %}
                    <option value="{{equipamento.id}}-{{equipamento.classe}}-{{equipamento.natureza}}-{{equipamento.valor_portal}}">
                      {{equipamento.titulo}}
                    </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="modalequipClasse" class="form-label text-primary"
                  >Classe</label
                >
                <select
                class="form-select"
                aria-label="Default"
                id="modalequipClasse"
                name="modalequipClasse"
                disabled
              >
                <option selected disabled>Escolha a Classe</option>
                <option value="consumo">Consumo</option>
                <option value="permanente">Permanente</option>
              </select>
              </div>
              <div class="col-md-6">
                <label for="modalequipNatureza" class="form-label text-primary"
                  >Natureza</label
                >
                <div class="d-flex align-items-center">
                  <select
                    class="form-select changeble-item"
                    aria-label="Default select example"
                    id="modalequipNatureza"
                    name="modalequipNatureza"
                    disabled
                  >
                    <option selected disabled>Escolha a Natureza</option>
                    <option value="material">Material</option>
                    <option value="servico">Serviço</option>
                    <option value="materialservico">Material/Serviço</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="modalequipEntrInst" class="form-label text-primary"
                  >Entrega/Instalação</label
                >
                <select
                class="form-select changeble-item"
                aria-label="Default"
                id="modalequipEntrInst"
                name="modalequipEntrInst"
                required
              >
                <option selected disabled>Status do item</option>
                <option value="demanda">Demanda</option>
                <option value="licitacao">Licitacao</option>
                <option value="aentregar">A entregar</option>
                <option value="entregue">Entregue</option>
                <option value="ainstalar">A instalar</option>
                <option value="instalado">Instalado</option>
              </select>
              </div>
              <div class="col-md-6">
                <label for="modalequipDest" class="form-label text-primary"
                  >Destino</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="modalequipDest"
                  name="modalequipDest"
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-4">
                <label for="modalequipValor1" class="form-label text-primary"
                  >Valor 1</label
                >
                <input
                type="text"
                id="modalequipValor1"
                class="form-control changeble-item"
                name="modalequipValor1"
                oninput="formatToCurrency(this)"
                onchange="calcMediaModel('modalequipValor1' ,'modalequipValor2', 'modalequipValor3', 'modalequipValorMedio')"
                />
              </div>
              <div class="col-md-4">
                <label for="modalequipValor2" class="form-label text-primary"
                  >Valor 2</label
                >
                <input
                type="text"
                id="modalequipValor2"
                class="form-control changeble-item"
                name="modalequipValor2"
                oninput="formatToCurrency(this)"
                onchange="calcMediaModel('modalequipValor1' ,'modalequipValor2', 'modalequipValor3', 'modalequipValorMedio')"
                />
              </div>
              <div class="col-md-4">
                <label for="modalequipValor3" class="form-label text-primary"
                  >Valor 3</label
                >
                <input
                type="text"
                id="modalequipValor3"
                class="form-control changeble-item"
                name="modalequipValor3"
                oninput="formatToCurrency(this)"
                onchange="calcMediaModel('modalequipValor1' ,'modalequipValor2', 'modalequipValor3', 'modalequipValorMedio')"
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-4">
                <label for="modalequipValorMedio" class="form-label text-primary"
                  >Valor Médio</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="modalequipValorMedio"
                  name="modalequipValorMedio"
                  readonly
                />
              </div>
              <div class="col-md-4">
                <label for="modalequipPrecoPortal" class="form-label text-primary"
                >Valor Portal</label
              >
              <input
                type="text"
                class="form-control"
                id="modalequipPrecoPortal"
                name="modalequipPrecoPortal"
                readonly
              />
              </div>
              <div class="col-md-4">
                <label for="modalequipValorUnit" class="form-label text-primary"
                  >Usar preço portal</label
                >
                <div class="form-check form-switch">
                  <input
                    class="form-check-input changeble-item"
                    type="checkbox"
                    id="modalequipValorUnit"
                    name="modalequipValorUnit"
                  />
                  <label
                    class="form-check-label"
                    for="modalequipValorUnit"
                    >Usar valor padrão do portal </label
                  >
              </div>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-4">
                <label for="modalequipQtd" class="form-label text-primary"
                  >Quantidade</label
                >
                <input
                  type="number"
                  class="form-control"
                  id="modalequipQtd"
                  name="modalequipQtd"
                />
              </div>
              <div class="col-md-4">
                <label for="modalequipValTot" class="form-label text-primary"
                  >Valor Total</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="modalequipValTot"
                  name="modalequipValTot"
                />
              </div>
              <div class="col-md-4">
                <label for="modalequipLocal" class="form-label text-primary"
                  >Local</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="modalequipLocal"
                  name="modalequipLocal"
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="modalequipDataEnt" class="form-label text-primary"
                  >Data Entrega</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="modalequipDataEnt"
                  name="modalequipDataEnt"
                />
              </div>
              <div class="col-md-6">
                <label for="modalequipDataInst" class="form-label text-primary"
                  >Data Instalação</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="modalequipDataInst"
                  name="modalequipDataInst"
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="modalequipObs" class="form-label text-primary"
                  >Observações</label
                >
                <textarea
                class="form-control changeble-item"
                style="height: 130px; font-size: 0.8em"
                id="modalequipObs"
                name="modalequipObs"
              ></textarea>
              </div>
            </div>
          </div>
          <input type="hidden" name="modalidpackageequip" id="modalidpackageequip" value="">
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Cria botão limpar-->
            <button type="reset" class="btn btn-warning">Limpar</button>
            <button type="submit" class="btn btn-success w-50">Salvar alterações</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- End Modal Edit Equpamento Scrollable-->
<!-- Modal Scrollable para Criar Equipamento Simples -->
<div class="modal fade" id="modalCreateEquip_Add" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title fw-bold">Criar Novo Equipamento</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form action="{% url 'createequipserv_edit' id_pacote %}" method="post">
          {% csrf_token %}
          <div class="container">
            <div class="row py-2">
              <div class="col-md-12">
                <label for="titleItem" class="form-label text-primary"
                  >Titulo</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="titleItem"
                  name="titleItem"
                  required
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="especItem" class="form-label text-primary"
                  >Especificação</label
                >
                <textarea
                  class="form-control"
                  style="height: 130px; font-size: 0.8em"
                  id="especItem"
                  name="especItem"
                  required
                ></textarea>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="categoryItem" class="form-label text-primary"
                  >Natureza</label
                >
                <select
                  class="form-select"
                  aria-label="Default"
                  id="categoryItem"
                  name="categoryItem"
                  required
                >
                  <option selected disabled>Escolha a Natureza</option>
                  <option value="material">Material</option>
                  <option value="servico">Serviço</option>
                  <option value="materialservico">Material/Serviço</option>
                </select>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="rpCode" class="form-label text-primary"
                  >Registro de Preço</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="rpCode"
                  name="rpCode"
                />
              </div>
              <div class="col-md-6">
                <label for="itemCode" class="form-label text-primary"
                  >Código Item</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="itemCode"
                  name="itemCode"
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="elItem" class="form-label text-primary"
                  >Elemento Item</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="elItem"
                  name="elItem"
                  maxlength="4"
                  required
                />
              </div>
              <div class="col-md-6">
                <label for="classItem" class="form-label text-primary"
                  >Classe</label
                >
                <select
                  class="form-select"
                  aria-label="Default"
                  id="classItem"
                  name="classItem"
                  required
                >
                  <option selected disabled>Escolha a Classe</option>
                  <option value="consumo">Consumo</option>
                  <option value="permanente">Permanente</option>
                </select>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="valPortItem" class="form-label text-primary"
                  >Valor Portal</label
                >
                <input
                  type="text"
                  id="valPortItem"
                  class="form-control"
                  name="valPortItem"
                  oninput="formatToCurrency(this)"
                />
              </div>
              <div class="col-md-6">
                <label for="sitItem" class="form-label text-primary"
                  >Situação</label
                >
                <select
                  class="form-select"
                  aria-label="Default"
                  id="sitItem"
                  name="sitItem"
                  required
                >
                  <option selected disabled>Situação do item</option>
                  <option value="ativo">Ativo</option>
                  <option value="inativo">Inativo</option>
                  <option value="suspenso">Suspenso</option>
                </select>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Cria botão limpar-->
            <button type="reset" class="btn btn-warning">Limpar</button>
            <button type="submit" class="btn btn-success w-50">Criar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- End Modal Scrollable para Criar Equipamento Simples-->
<!-- Modal Scrollable para Criar Task -->
<div class="modal fade" id="modalCreateTask_Add" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title fw-bold">Criar Nova Tarefa Cronograma</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form action="{% url 'createtaskfull' id_pacote %}" method="post">
          {% csrf_token %}
          <div class="container">
            <div class="row py-2">
              <div class="col-md-12">
                <label for="titleItemTask" class="form-label text-primary"
                  >Titulo</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="titleItemTask"
                  name="titleItemTask"
                  required
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="descItemTask" class="form-label text-primary"
                  >Descrição</label
                >
                <textarea
                  class="form-control"
                  style="height: 130px; font-size: 0.8em"
                  id="descItemTask"
                  name="descItemTask"                     
                ></textarea>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="statusItemTask" class="form-label text-primary"
                  >Status</label
                >
                <select
                  class="form-select"
                  aria-label="Default"
                  id="statusItemTask"
                  name="statusItemTask"
                  required
                >
                  <option selected disabled>Escolha o Status</option>
                  <option value="pendente">Pendente</option>
                  <option value="emexecucao">Em execução</option>
                  <option value="concluido">Concluído</option>
                </select>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="prioriItemTask" class="form-label text-primary"
                  >Prioridade</label
                >
                <select
                  class="form-select"
                  aria-label="Default"
                  id="prioriItemTask"
                  name="prioriItemTask"
                >
                  <option selected disabled>Escolha o Status</option>
                  <option value="baixa">Baixa</option>
                  <option value="media">Média</option>
                  <option value="alta">Alta</option>
                </select>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="initItemTask" class="form-label text-primary"
                  >Data Inicio Planejada</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="initItemTask"
                  name="initItemTask"
                  
                />
              </div>
              <div class="col-md-6">
                <label for="fimItemTask" class="form-label text-primary"
                  >Data Fim Planejada</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="fimItemTask"
                  name="fimItemTask"
                  
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="initRealTask" class="form-label text-primary"
                  >Data Inicio Real</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="initRealTask"
                  name="initRealTask"
                  
                />
              </div>
              <div class="col-md-6">
                <label for="fimRealTask" class="form-label text-primary"
                  >Data Fim Real</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="fimRealTask"
                  name="fimRealTask"
                  
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="obsItemTask" class="form-label text-primary"
                  >Observações</label
                >
                <textarea
                class="form-control"
                style="height: 130px; font-size: 0.8em"
                id="obsItemTask"
                name="obsItemTask"
              ></textarea>
              </div>

            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Cria botão limpar-->
            <button type="reset" class="btn btn-warning">Limpar</button>
            <button type="submit" class="btn btn-success w-50">Criar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- End Modal Scrollable para Criar Task-->
  <!-- Modal Delete Task Inicio -->
  <div class="modal fade" id="modalDeleteTask" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="modaltitletask" class="modal-title fw-bold text-danger h3">Excluir Task </h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <form id="formDelTask" data-action="{% url 'deletetask' 0 %}" method="POST">
            {% csrf_token %}
            <h5 class="card-title"> Realmente deseja apagar permanentemente a Task?</h5>
            <button type="submit" class="btn btn-danger btn-lg m-3">Excluir</button>
            <button
            type="button"
            class="btn btn-secondary btn-lg m-3"
            data-bs-dismiss="modal"
            >
            Cancelar
          </button>
        </form>
        </div>

      </div>
    </div>
  </div>
  <!-- Modal Delete Task Fim -->
<!-- Modal Edit Task Scrollable -->
<div class="modal fade" id="modalEditTask" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable modal-custom">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modaltitletask" class="modal-title fw-bold">Editar Task </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="formEditTask" data-action="{% url 'editeachtask' 0 %}" method="POST">
          {% csrf_token %}
          <div class="container">
            <div class="row py-2">
              <div class="col-md-12">
                <label for="titleEditTask" class="form-label text-primary"
                  >Titulo</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="titleEditTask"
                  name="titleEditTask"
                  required
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="descEditTask" class="form-label text-primary"
                  >Descrição</label
                >
                <textarea
                  class="form-control"
                  style="height: 130px; font-size: 0.8em"
                  id="descEditTask"
                  name="descEditTask"                     
                ></textarea>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="statusEditTask" class="form-label text-primary"
                  >Status</label
                >
                <select
                  class="form-select"
                  aria-label="Default"
                  id="statusEditTask"
                  name="statusEditTask"
                  required
                >
                  <option selected disabled>Escolha o Status</option>
                  <option value="pendente">Pendente</option>
                  <option value="emexecucao">Em execução</option>
                  <option value="concluido">Concluído</option>
                </select>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="prioriEditTask" class="form-label text-primary"
                  >Prioridade</label
                >
                <select
                  class="form-select"
                  aria-label="Default"
                  id="prioriEditTask"
                  name="prioriEditTask"
                >
                  <option selected disabled>Escolha o Status</option>
                  <option value="baixa">Baixa</option>
                  <option value="media">Média</option>
                  <option value="alta">Alta</option>
                </select>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="initEditTask" class="form-label text-primary"
                  >Data Inicio Planejada</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="initEditTask"
                  name="initEditTask"
                  
                />
              </div>
              <div class="col-md-6">
                <label for="fimEditTask" class="form-label text-primary"
                  >Data Fim Planejada</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="fimEditTask"
                  name="fimEditTask"
                  
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-6">
                <label for="initRealEditTask" class="form-label text-primary"
                  >Data Inicio Real</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="initRealEditTask"
                  name="initRealEditTask"
                  
                />
              </div>
              <div class="col-md-6">
                <label for="fimRealEditTask" class="form-label text-primary"
                  >Data Fim Real</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="fimRealEditTask"
                  name="fimRealEditTask"
                  
                />
              </div>
            </div>
            <div class="row py-2">
              <div class="col-md-12">
                <label for="obsEditTask" class="form-label text-primary"
                  >Observações</label
                >
                <textarea
                class="form-control"
                style="height: 130px; font-size: 0.8em"
                id="obsEditTask"
                name="obsEditTask"
              ></textarea>
              </div>

            </div>
          </div>
          <input type="hidden" name="modalidpackagetask" id="modalidpackagetask" value="">
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Cria botão limpar-->
            <button type="reset" class="btn btn-warning">Limpar</button>
            <button type="submit" class="btn btn-success w-50">Salvar alterações</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- End Modal Edit Task Scrollable-->
<!-- Modal Scrollable para Criar ObsPen -->
<div class="modal fade" id="modalCreateObsPen" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable modal-custom">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title fw-bold">Criar Nova Observação/Pendência</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form action="{% url 'createobspenfull' id_pacote %}" method="post">
          {% csrf_token %}
          <div class="container">
            <div class="row py-2">
              <div class="col-xxl-12 col-md-12">
                <div class="card info-card revenue-card">
                  <div class="card-body">
                    <h5 class="card-title">
                      DESCRIÇÃO
                      <span
                        >| Faça uma breve descrição da sua observação ou
                        pendencia</span
                      >
                    </h5>
                    <div class="d-flex align-items-center">
                      <!--MAIN CONTENT-->
                      <div class="row w-100">
                        <div class="col-md-12">
                          <textarea
                            class="form-control changeble-item"
                            style="height: 130px; font-size: 0.8em"
                            id="descObsPen_create"
                            name="descObsPen_create"
                          ></textarea>
                        </div>
                      </div>
                      <!--MAIN CONTENT-->
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row py-2">
              <div class="col-xxl-12 col-md-12">
                <div class="card info-card revenue-card">
                  <div class="card-body">
                    <h5 class="card-title">
                      CATEGORIA
                      <span>| Selecione a categoria do registro</span>
                    </h5>
                    <div class="d-flex align-items-center">
                      <select
                        class="form-select changeble-item"
                        aria-label="Default select example"
                        id="selectCategoria_ObsPen_create"
                        name="cat_obspen"
                      >
                        <option selected disabled>Escolha a categoria</option>
                        <option value="pendencia">Pendência</option>
                        <option value="observacao">Observação</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

            </div>
            <div class="row py-2">
              <div class="col-xxl-12 col-md-12">
                <div class="card info-card revenue-card">
                  <div class="card-body">
                    <h5 class="card-title">
                      DATA
                      <span>| Informe a data ou pendencia da reclamação</span>
                    </h5>
                    <div class="d-flex align-items-center">
                      <input
                        type="date"
                        class="form-control changeble-item"
                        id="dateObsPen_edit"
                        name="dateObsPen_create"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Cria botão limpar-->
            <button type="reset" class="btn btn-warning">Limpar</button>
            <button type="submit" class="btn btn-success w-50">Criar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- End Modal Scrollable para Criar OBsPen-->
<!-- Modal Delete Obs/Pen Inicio -->
<div class="modal fade" id="modalDeleteObsPen" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modaltitleObsPen" class="modal-title fw-bold text-danger h3">Excluir Observação/Pendência</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="formDelObsPen" data-action="{% url 'deleteobspen' 0 %}" method="POST">
          {% csrf_token %}
          <h5 class="card-title"> Realmente deseja apagar permanentemente a Observação/Pendência?</h5>
          <button type="submit" class="btn btn-danger btn-lg m-3">Excluir</button>
          <button
          type="button"
          class="btn btn-secondary btn-lg m-3"
          data-bs-dismiss="modal"
          >
          Cancelar
        </button>
      </form>
      </div>

    </div>
  </div>
</div>
<!-- Modal Delete Obs/Pen Fim -->
<!-- Modal Edit OBsPen Scrollable -->
<div class="modal fade" id="modalEditObsPen" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable modal-custom">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modaltitleobspen" class="modal-title fw-bold">Editar OBservação/Pendencia</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="formEditObsPen" data-action="{% url 'editobspen' 0 %}" method="POST">
          {% csrf_token %}
            <div class="container">
              <div class="row py-2">
                <div class="col-xxl-12 col-md-12">
                  <div class="card info-card revenue-card">
                    <div class="card-body">
                      <h5 class="card-title">
                        DESCRIÇÃO
                        <span
                          >| Faça uma breve descrição da sua observação ou
                          pendencia</span
                        >
                      </h5>
                      <div class="d-flex align-items-center">
                        <!--MAIN CONTENT-->
                        <div class="row w-100">
                          <div class="col-md-12">
                            <textarea
                              class="form-control changeble-item"
                              style="height: 130px; font-size: 0.8em"
                              id="descObsPen_edit"
                              name="descObsPen_edit"
                            ></textarea>
                          </div>
                        </div>
                        <!--MAIN CONTENT-->
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row py-2">
                <div class="col-xxl-12 col-md-12">
                  <div class="card info-card revenue-card">
                    <div class="card-body">
                      <h5 class="card-title">
                        CATEGORIA
                        <span>| Selecione a categoria do registro</span>
                      </h5>
                      <div class="d-flex align-items-center">
                        <select
                          class="form-select changeble-item"
                          aria-label="Default select example"
                          id="selectCategoria_ObsPen_edit"
                          name="cat_obspen_edit"
                        >
                          <option selected disabled>Escolha a categoria</option>
                          <option value="pendencia">Pendência</option>
                          <option value="observacao">Observação</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
  
              </div>
              <div class="row py-2">
                <div class="col-xxl-12 col-md-12">
                  <div class="card info-card revenue-card">
                    <div class="card-body">
                      <h5 class="card-title">
                        DATA
                        <span>| Informe a data ou pendencia da reclamação</span>
                      </h5>
                      <div class="d-flex align-items-center">
                        <input
                          type="date"
                          class="form-control changeble-item"
                          id="dateObsPen_edit_full"
                          name="dateObsPen_edit"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
          </div>
          <input type="hidden" name="modalidpackageobspen" id="modalidpackageobspen" value="">
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Cria botão limpar-->
            <button type="reset" class="btn btn-warning">Limpar</button>
            <button type="submit" class="btn btn-success w-50">Salvar alterações</button>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- End Modal Edit OBsPen Scrollable-->
<script>
    // Criação de novo equipamento Full
    const modalCreateFullEquip = document.getElementById('modalCreateFullEquip')
    if(modalCreateFullEquip){
      modalCreateFullEquip.addEventListener('show.bs.modal', function (event) {
        // Executa a função formatToCurrency nos campor de valor do model
        formatToCurrency(document.querySelector('#modalequipFullValor1'))
        formatToCurrency(document.querySelector('#modalequipFullValor2'))
        formatToCurrency(document.querySelector('#modalequipFullValor3'))
        formatToCurrency(document.querySelector('#modalequipFullValorMedio'))
        formatToCurrency(document.querySelector('#modalequipFullPrecoPortal'))
      });
    }

      // Troca o data-action do modal que apaga equipamento
    const modalDeleteEquip = document.getElementById('modalDeleteEquip')
    if(modalDeleteEquip){
      modalDeleteEquip.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        const button = event.relatedTarget
        // Extraindo de data-bs-* o conteudo
        const packagedelequip = button.getAttribute('data-bs-packagedelequip')
        console.log(`packagedelequip: ${packagedelequip}`)
        const formDelEquip = document.querySelector('#formDelEquip')
        let url = formDelEquip.getAttribute("data-action");
        url = url.replace('0',packagedelequip)
        formDelEquip.setAttribute("action", url);


    })
  }

  // Troca o data-action do modal que apaga task
  const modalDeleteTask = document.getElementById('modalDeleteTask')
  if(modalDeleteTask){
    modalDeleteTask.addEventListener('show.bs.modal', function (event) {
      // Button that triggered the modal
      const button = event.relatedTarget
      // Extraindo de data-bs-* o conteudo
      const packagedeltask = button.getAttribute('data-bs-packagedeltask')
      const formDelTask = document.querySelector('#formDelTask')
      let url = formDelTask.getAttribute("data-action");
      url = url.replace('0',packagedeltask)
      formDelTask.setAttribute("action", url);
  })
  }

  // Troca o data-action do modal que apaga obspen
  const modalDeleteObsPen = document.getElementById('modalDeleteObsPen')
  if(modalDeleteObsPen){
    modalDeleteObsPen.addEventListener('show.bs.modal', function (event) {
      // Button that triggered the modal
      const button = event.relatedTarget
      // Extraindo de data-bs-* o conteudo
      const idobspen = button.getAttribute('data-bs-idobspen')
      const formDelObsPen = document.querySelector('#formDelObsPen')
      let url = formDelObsPen.getAttribute("data-action");
      url = url.replace('0',idobspen)
      formDelObsPen.setAttribute("action", url);
  })
  }

  function geramediavalor(val1, val2, val3){
    // Recebe os tres parametros de valor no formato R$ xXX.XXX,XX e retorna a media
    // Retira o R$ e o ponto
    val1 = val1.replace('R$', '')
    val1 = val1.replace('.', '')
    val2 = val2.replace('R$', '')
    val2 = val2.replace('.', '')
    val3 = val3.replace('R$', '')
    val3 = val3.replace('.', '')
    // Retira a virgula e transforma em float
    val1 = parseFloat(val1.replace(',', '.'))
    val2 = parseFloat(val2.replace(',', '.'))
    val3 = parseFloat(val3.replace(',', '.'))
    // Calcula a media
    let media = (val1 + val2 + val3) / 3
    // Formata a media para o formato R$ xXX.XXX,XX
    media = media.toLocaleString('pt-br',{style: 'currency', currency: 'BRL'})
    return media
  }
    // Alimentação do Modal para ediçao de equipamentos
    const modalEditEquip = document.getElementById('modalEditEquip')
    if(modalEditEquip){

      modalEditEquip.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        const button = event.relatedTarget
        // Extraindo de data-bs-* o conteudo

        const equipTitulo = button.getAttribute('data-bs-equipamento.titulo')
        const equipId = button.getAttribute('data-bs-equipamento.id')
        const equipClasse = button.getAttribute('data-bs-equipamento.classe')
        const equipNatureza = button.getAttribute('data-bs-equipamento.natureza')
        const equipEntrInst = button.getAttribute('data-bs-entrega_instalacao')
        const equipValor1 = button.getAttribute('data-bs-equip.valor_1')
        const equipValor2 = button.getAttribute('data-bs-equip.valor_2')
        const equipValor3 = button.getAttribute('data-bs-equip.valor_3')
        const equipPrecoPortal = button.getAttribute('data-bs-valor_preco_portal')
        const usaPrecoPortal = JSON.parse(button.getAttribute('data-bs-usa_preco_portal').toLowerCase())
        const equipValorUnit = button.getAttribute('data-bs-equip.valor_unit')
        const equipQtd = button.getAttribute('data-bs-equip.quantidade')
        const equipValTot = button.getAttribute('data-bs-equip.valor_total')
        const equipLocal= button.getAttribute('data-bs-equip.local')
        const equipEntr = button.getAttribute('data-bs-equip.data_entrega')
        const equipDataInst = button.getAttribute('data-bs-equip.data_instalacao')
        const equipObs = button.getAttribute('data-bs-equip.observacoes')
        const equipDest = button.getAttribute('data-bs-equip.destino')
        const packageequipid = button.getAttribute('data-bs-packageequip')

        console.log(`usaPrecoPortal: ${usaPrecoPortal}`)
        console.log(`usaPrecoPortal: ${typeof usaPrecoPortal}`)



        // Atualizando campos do meu model Equipamentos
        const modaltitleequip =  document.querySelector("#modalEditEquip > div:nth-child(1) > div:nth-child(1) > div:nth-child(1) > h5:nth-child(1)")
        const modalEquipList = document.querySelector('#modalEquipList')
        const modalequipClasse = document.querySelector('#modalequipClasse')
        const modalequipNatureza = document.querySelector('#modalequipNatureza')
        const modalequipEntrInst = document.querySelector('#modalequipEntrInst')
        const modalequipDest = document.querySelector('#modalequipDest')
        const modalequipValor1 = document.querySelector('#modalequipValor1')
        const modalequipValor2 = document.querySelector('#modalequipValor2')
        const modalequipValor3 = document.querySelector('#modalequipValor3')
        const modalequipValorMedio = document.querySelector('#modalequipValorMedio')
        const modalequipPrecoPortal = document.querySelector('#modalequipPrecoPortal')
        const modalequipUsaValorP = document.querySelector('#modalequipValorUnit')
        const modalequipQtd = document.querySelector('#modalequipQtd')
        const modalequipValTot = document.querySelector('#modalequipValTot')
        const modalequipLocal = document.querySelector('#modalequipLocal')
        const modalequipDataEnt = document.querySelector('#modalequipDataEnt')
        const modalequipDataInst = document.querySelector('#modalequipDataInst')
        const modalequipObs = document.querySelector('#modalequipObs')
        const modalidpackageequip = document.querySelector('#modalidpackageequip')


        // Rotulos dinamicos de acordo com a resposta
        modaltitleequip.textContent =  "Editar - " + equipTitulo
        modalEquipList.value = equipId
        modalequipClasse.value = equipClasse
        modalequipNatureza.value = equipNatureza
        modalequipEntrInst.value = equipEntrInst
        modalequipDest.value = equipDest
        modalequipValor1.value = equipValor1
        modalequipValor2.value = equipValor2
        modalequipValor3.value = equipValor3
        modalequipValorMedio.value = geramediavalor(equipValor1, equipValor2, equipValor3)
        modalequipPrecoPortal.value = equipPrecoPortal
        modalequipUsaValorP.checked = usaPrecoPortal
        modalequipQtd.value = equipQtd
        modalequipValTot.value = equipValTot
        modalequipLocal.value = equipLocal
        modalequipDataEnt.value = equipEntr
        modalequipDataInst.value = equipDataInst
        modalequipObs.value = equipObs
        modalidpackageequip.value = packageequipid

        // Ajusta a url do form do modal
        const formEditEquip = document.querySelector('#formEditEquip')
        console.log(`formEditEquip: ${formEditEquip.hasAttribute("data-action")}`)
        let url = formEditEquip.getAttribute("data-action");
        console.log(`url: ${url}`)
        url = url.replace('0',packageequipid)
        formEditEquip.setAttribute("action", url);

        // fazer com que seja carregada a função formatToCurrency() em cada um dos campos de valor
        formatToCurrency(modalequipValor1)
        formatToCurrency(modalequipValor2)
        formatToCurrency(modalequipValor3)
        formatToCurrency(modalequipPrecoPortal)
        formatToCurrency(modalequipValTot)

      })
      calcMediaModel('modalequipValor1' ,'modalequipValor2', 'modalequipValor3', 'modalequipValorMedio')


    }


    // Alimentação do Modal para ediçao de equipamentos
    const modalEditTask = document.getElementById('modalEditTask')
    if(modalEditTask){

      modalEditTask.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        const button = event.relatedTarget
        // Extraindo de data-bs-* o conteudo

        const taskTitulo = button.getAttribute('data-bs-titletask')
        const taskId = button.getAttribute('data-bs-idtask')
        const taskDesc = button.getAttribute('data-bs-desctask')
        const taskStatus = button.getAttribute('data-bs-statustask')
        const taskPriori = button.getAttribute('data-bs-prioritask')
        const taskInit = button.getAttribute('data-bs-initask')
        const taskFim = button.getAttribute('data-bs-fimtask')
        const taskInitReal = button.getAttribute('data-bs-inirealtask')
        const taskFimReal = button.getAttribute('data-bs-fimrealtask')
        const taskObs = button.getAttribute('data-bs-obs')
        const packageTaskId = button.getAttribute('data-bs-idpacote')

      // Atualizando campos do meu model task
      const modalEditTask = document.getElementById('modalEditTask')
      const modaltitletask =  document.querySelector("#modalEditTask > div:nth-child(1) > div:nth-child(1) > div:nth-child(1) > h5:nth-child(1)")
      const modalidpackagetask = document.querySelector('#modalidpackagetask')
      const modaltitletaskedit = document.querySelector('#titleEditTask')
      const modaldesctaskedit = document.querySelector('#descEditTask')
      const modalstatustaskedit = document.querySelector('#statusEditTask')
      const modalprioritaskedit = document.querySelector('#prioriEditTask')
      const modalinittaskedit = document.querySelector('#initEditTask')
      const modalfimtaskedit = document.querySelector('#fimEditTask')
      const modalinitrealtaskedit = document.querySelector('#initRealEditTask')
      const modalfimrealtaskedit = document.querySelector('#fimRealEditTask')
      const modalobstaskedit = document.querySelector('#obsEditTask')

      // Rotulos dinamicos de acordo com a resposta
      modaltitletask.textContent =  "Editar - " + taskTitulo
      modalidpackagetask.value = packageTaskId
      modaltitletaskedit.value = taskTitulo
      modaldesctaskedit.value = taskDesc
      modalstatustaskedit.value = taskStatus
      modalprioritaskedit.value = taskPriori
      modalinittaskedit.value = taskInit
      modalfimtaskedit.value = taskFim
      modalinitrealtaskedit.value = taskInitReal
      modalfimrealtaskedit.value = taskFimReal
      modalobstaskedit.value = taskObs

      // Ajusta a url do form do modal
      const formEditTask = document.querySelector('#formEditTask')
      console.log(`formEditTask: ${formEditTask.hasAttribute("data-action")}`)
      let url = formEditTask.getAttribute("data-action");
      url = url.replace('0',taskId)
      formEditTask.setAttribute("action", url);

        })
    }

    // Alimentação do Modal para ediçao de ObsPen
    const modalEditObsPen = document.getElementById('modalEditObsPen')
    if(modalEditObsPen){

      modalEditObsPen.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        const button = event.relatedTarget
        // Extraindo de data-bs-* o conteudo

        const obspenId = button.getAttribute('data-bs-idobspen')
        const obspenDesc = button.getAttribute('data-bs-descobspen')
        const obspenCat = button.getAttribute('data-bs-catobspen')
        const obspenDate = button.getAttribute('data-bs-dateobspen')
        const packageObsPenId = button.getAttribute('data-bs-idpacote')

      // Atualizando campos do meu model task
      const modalEditObsPen = document.getElementById('modalEditObsPen')
      const modaltitleobspen =  document.querySelector("#modalEditObsPen > div:nth-child(1) > div:nth-child(1) > div:nth-child(1) > h5:nth-child(1)")
      const modalidpackageobspen = document.querySelector('#modalidpackageobspen')
      const modaldescobspenedit = document.querySelector('#descObsPen_edit')
      const modalcatobspenedit = document.querySelector('#selectCategoria_ObsPen_edit')
      const modaldateobspenedit = document.querySelector('#dateObsPen_edit_full')

      // Rotulos dinamicos de acordo com a resposta
      modaltitleobspen.textContent =  "Editar - " + obspenDesc
      modalcatobspenedit.value = obspenCat
      modalidpackageobspen.value = packageObsPenId
      modaldescobspenedit.value = obspenDesc
      modaldateobspenedit.value = obspenDate

      // Ajusta a url do form do modal
      const formEditObsPen = document.querySelector('#formEditObsPen')
      console.log(`formEditObsPen: ${formEditObsPen.hasAttribute("data-action")}`)
      let url = formEditObsPen.getAttribute("data-action");
      url = url.replace('0',obspenId)
      formEditObsPen.setAttribute("action", url);

        })
    }

     // Ajusta display para RP, PG e terceiros
     const statusSelect = document.querySelector("#selectStatusNew_edit");
     const rpSelect = document.getElementById("selectnewrp_edit");
     const pgSelect = document.getElementById("selectnewpg_edit");
     const terceirosElement = document.getElementById("terceiros_edit");

     // inicia ambos selects ocultos
     rpSelect.style.display = "none";
     pgSelect.style.display = "none";

     statusSelect.addEventListener("change", function () {
       // esconde ambos selects
       rpSelect.style.display = "none";
       pgSelect.style.display = "none";
       terceirosElement.style.display = "block"; // mostra "terceiros"
       terceirosElement.textContent = "Terceiros";

       if (this.value === "RP") {
         rpSelect.style.display = "block";
         terceirosElement.style.display = "none"; // oculta "terceiros"
       } else if (this.value === "PG") {
         pgSelect.style.display = "block";
         terceirosElement.style.display = "none"; // oculta "terceiros"
       }
     });

     document
     .getElementById("button-addon1-new_edit")
     .addEventListener("click", function () {
       const inputText = document.getElementById("inputText-new_edit");
       const listContainer = document.getElementById("listContainer-new");

       // Verifica se o texto já existe na lista
       if (!listContainer.innerHTML.includes(inputText.value)) {
        if (inputText.value){
        // Cria um novo item da lista
         const newItem = document.createElement("div");
         newItem.classList.add(
           "d-flex",
           "flex-row",
           "justify-content-between",
           "w-100",
           "align-items-center",
           "mb-1"
         );
         newItem.innerHTML = `<p class="labelsei">${inputText.value}</p> <button class="btn btn-danger btn-sm me-2" onclick="removeItem(event)">X</button>`;

         // Adiciona o novo item à lista
         listContainer.appendChild(newItem);
       }


        }
       // Limpa o campo de entrada
       inputText.value = "";

     });



   function removeItem(event) {
     const item = event.target.parentNode;
     item.parentNode.removeChild(item);
   }
   // Função que será chamada sempre que um elemento for adicionado ou removido de "maincontent"
   // Seleciona o nó que será observado
   const targetNode = document.getElementById("listContainer-new");

   // Cria uma instância de observer
   const observer = new MutationObserver((mutationsList, observer) => {
     // Itera sobre todas as mutações que acabaram de ocorrer
     for (let mutation of mutationsList) {
       // Se o `mutation.type` for `childList`, adiciona o conteúdo do elemento p ao input hidden
       if (mutation.type === "childList") {
         let textValues = "";
         let childDivs = targetNode.children;
         for (let i = 0; i < childDivs.length; i++) {
           // Acessa o conteúdo do elemento p dentro da div
           let pContent =childDivs[i].getElementsByTagName("p")[0].textContent;
           textValues += pContent + ";";
         }

         // Remove o último ';'
         textValues = textValues.slice(0, -1);

         // Armazena os valores no input hidden
         if(!textValues){
          document.getElementById("hiddensei_edit").value = "SET_FAILURE_SEI"
          return
         }
         document.getElementById("hiddensei_edit").value = textValues;
       }
     }
   });

   // Configuração do observer: quais mutações serão observadas
   const config = { attributes: false, childList: true, subtree: false };
   // Inicia a observação do nó configurado
   observer.observe(targetNode, config);


   function calcMediaModel(idv1, idv2, idv3, idvm) {
    let nota1 = parseFloat(document.getElementById(idv1).value == "" ? 0 : document.getElementById(idv1).value.replace("R$ ", "").replace(".", "").replace(",", "."));
    let nota2 = parseFloat(document.getElementById(idv2).value == "" ? 0 : document.getElementById(idv2).value.replace("R$ ", "").replace(".", "").replace(",", "."));
    let nota3 = parseFloat(document.getElementById(idv3).value == "" ? 0 : document.getElementById(idv3).value.replace("R$ ", "").replace(".", "").replace(",", "."));
    let cont = 0;

    if (nota1 != 0) {
        cont++;
    }
    if (nota2 != 0) {
        cont++;
    }
    if (nota3 != 0) {
        cont++;
    }
    let media = (nota1 + nota2 + nota3) / cont;
    media = media.toFixed(2);
    //Tratamento para quando o usuário não digitar nada
    media = String(media);
    media = media.replace(/[\D]/g, ""); // Remove tudo que não é número
    media = media.replace(/(\d)(\d{2})$/, "$1,$2"); // Coloca vírgula antes dos últimos 2 dígitos
    media = media.replace(/(?=(\d{3})+(\D))\B/g, "."); // Coloca ponto a cada 3 dígitos

    document.getElementById(idvm).value = `R$ ${media}`;
  }

  // Configuração para aparecer ou não o equipamento ou serviço no selectCategoria
  document.addEventListener('DOMContentLoaded', function() {
    var selectCategoria = document.getElementById('selectCategoria_edit');
    var selectEquip = document.getElementById('selectEquip_edit');

    // Configura RP, PG E Terceiros
         // Ajusta display para RP, PG e terceiros
         const statusSelect = document.querySelector("#selectStatusNew_edit");
         const rpSelect = document.getElementById("selectnewrp_edit");
         const pgSelect = document.getElementById("selectnewpg_edit");
         const terceirosElement = document.getElementById("terceiros_edit");
    
         // inicia ambos selects ocultos
         rpSelect.style.display = "none";
         pgSelect.style.display = "none";
    

           // esconde ambos selects
           rpSelect.style.display = "none";
           pgSelect.style.display = "none";
           terceirosElement.style.display = "block"; // mostra "terceiros"
    
           if (statusSelect.value === "RP") {
             rpSelect.style.display = "block";
             terceirosElement.style.display = "none"; // oculta "terceiros"
           } else if (statusSelect.value === "PG") {
             pgSelect.style.display = "block";
             terceirosElement.style.display = "none"; // oculta "terceiros"
           }


    selectCategoria.addEventListener('change', function(){
      // Limpa as opções existentes
      selectEquip.innerHTML = '';

      // Adiciona a opção "disabled" no início
      var defaultOption = document.createElement('option');
      defaultOption.setAttribute('selected', '');
      defaultOption.setAttribute('disabled', '');
      defaultOption.innerText = 'Escolha o equipamento/serviço';
      selectEquip.appendChild(defaultOption);

      // Adiciona as opções correspondentes ao natureza selecionado
      {% for equipamento in all_equipamentos %}
        if ('{{equipamento.natureza}}' == selectCategoria.value) {
          var option = document.createElement('option');
          option.value = "{{equipamento.id}}-{{equipamento.classe}}-{{equipamento.natureza}}-{{equipamento.valor_portal}}";
          option.innerText = "{{equipamento.titulo}}";
          selectEquip.appendChild(option);
        }
      {% endfor %}
    });
    // Deixa a input hidden de sei vazio para não salvar
    document.getElementById("hiddensei_edit").value = ""
    fillDifferenceInTable()

  });

  function fillDifferenceInTable() {
    const tableRows = document.querySelector('#listTaskTable_edit');

    


    // Começa do 1 para pular o cabeçalho da tabela
    for (let i = 1; i < tableRows.rows.length; i++) {
      const cells = tableRows.rows[i].cells;
      console.log(`cells: ${cells}`)
      const date1 = cells[8].textContent; // índice 8 para a 9ª coluna
      const date2 = cells[9].textContent; // índice 9 para a 10ª coluna
      const difference = dateDifference(date1, date2);
      cells[10].textContent = difference; // índice 5 para a 6ª coluna
    }
  }

  // Chame a função fillDifferenceInTable() após a tabela ter sido completamente carregada
  document.addEventListener('DOMContentLoaded', fillDifferenceInTable);


  function parseDate(dateStr) {
    const [day, month, year] = dateStr.split('/').map(Number);
    return new Date(year, month - 1, day);
  }

  function dateDifference(dateStr1, dateStr2) {
    const date1 = parseDate(dateStr1);
    const date2 = parseDate(dateStr2);

    const diffInMilliseconds = date2 - date1;
    const diffInDays = Math.round(diffInMilliseconds / (1000 * 60 * 60 * 24));

    return diffInDays;
  }


  function putModelData(){
    // buscar o valor que está em selectEquip_edit
    const selectEquip = document.getElementById('selectEquip_edit');
    // separa os valores em value através do split utilizando o delimitador '-' e gravando os valores em id e classe respectivamente. Posteriormente pega o conteudo do texto da option e grava em titulo
    const [id, classe, natureza, valor_portal] = selectEquip.value.split('-');
    const titulo = selectEquip.options[selectEquip.selectedIndex].text;
    console.log(`id: ${id}`)
    console.log(`classe: ${classe}`)
    console.log(`titulo: ${titulo}`)
    console.log(`natureza: ${natureza}`)
    console.log(`valor_portal: ${valor_portal}`)
    // No modal que irá se abrir ao pressionar o botão "Adicionar Equipamento" deverá injetar no campo "Titulo" o valor de titulo, no select Equipamentos o value será o id, no campo classe o value será classe e no campo especificação o value será o id
    document.getElementById('modalEquipFullList').value = id;
    document.getElementById('modalequipFullClasse').value = classe;
    document.getElementById('modalequipFullNatureza').value = natureza;
    document.getElementById('modalequipFullPrecoPortal').value = `R$ ${valor_portal}`;
    document.getElementById('modaltitleequip').textContent = `Adicionar - ${titulo}`;

  }
  function setHidden(){
    document.getElementById('modalequipFullNaturezaHidden').value = document.getElementById('modalequipFullNatureza').value;
    document.getElementById('modalequipFullClasseHidden').value = document.getElementById('modalequipFullClasse').value;
    document.getElementById('modalEquipFullListHidden').value = document.getElementById('modalEquipFullList').value;
  }

  function loadclassnatprice(){
    const [id, classe, natureza, valor_portal] = document.getElementById('modalEquipList').value.split('-');
    document.getElementById('modalequipClasse').value = classe;
    document.getElementById('modalequipNatureza').value = natureza;
    document.getElementById('modalequipPrecoPortal').value = `R$ ${valor_portal}`;
  }
</script>
{% endblock %}
